---
title: tls
---



# TLS 



## 1. TLS 认证过程



我们需要在网络中实现安全通信，最直接的思路是，将内容通过某种手段加密，再通过某种手段解密。

这个手段可以有两种：

1. 非对称加密。比如 RSA，ECC 算法，加解密过程是不可逆的，可以方便地对于数据进行签名/验证，但是计算速度慢
2. 对称加密。计算速度快，加密强度大，但关键是，加解密用的是相同的密钥，需要通过安全的手段传输密钥才行。





 





## 2. TLS 证书类型



ssl/tls 有多种文件格式，主要的文件有：PEM, DER, PFX, JKS, KDB, CER, KEY, CRT, CSR，同时也会设计到几个协议，如 CRL, OCSP, SCEP  等，下面主要针对常用的文件格式和协议进行解释



### 2.1 introduction

其实上面的证书类型，笼统来说叫做类型，细分起来，区别还是很大的，可以大致划分为：

1. 编码格式
2. 文件扩展名



### 2.2 编码格式

编码格式可以分为 PEM 和 DER 两种，

1. PEM（private enhanced mail）

   ​	Openssl 默认使用 PEM 格式（文本）来存放各种信息，这是 openssl 默认的存放方式，一般 PEM 文件包含一下信息：

   - 内容类型。表示本文件存放的是什么内容的信息，以 `-----BEGIN XXX-----` 开始，以 `-----END XXX-----` 结束，XXX 可以是 `PRIVATE KEY` ，也可以是 `CERTIFICATE`，分别表示这是一个私钥还是公钥。
   - 头部信息。表示数据加密处理的方式，一般等同于加密算法+初始化向量。
   - 信息内容。BASE64 编码之后的数据。

2. DER（distinguished encoding rules）

   ​	 使用了二进制格式进行存储，对人类不友好。





### 2.3 文件扩展名



这里是比较迷惑人的地方，虽然编码格式就 PEM 和 DER 两种，但是，文件扩展名千奇百怪。



1. CRT。certificate 的缩写，常见于 *NIX 系统，编码格式 unknown，如果为 PEM 编码，上面已经说明如何辨别
1. CET。还是certificate，常见于Windows系统，同样编码格式 unknown，不过大多数应该是 DER 编码
1. KEY。这个含义应该很明确了，钥匙，可以是私钥，也可以是公钥，编码格式unknown。
1. PFX/P12。 对*NIX 服务器来说，一般 CRT 和 KEY 是分开存放在不同文件中的，但 Windows 则将它们存在一个PFX文件中（因此这个文件同时包含了证书及私钥）并且 PFX通常会有一个“密码”，如果你想把里面的东西读取出来的话，它就要求你提供提取密码
1. CSR。certificate signing request，即证书签名请求，这个并不是证书，而是向权威证书办法机构获取签名证书的申请，核心内容是一个公钥，在生成公钥的时候，同时还会生成一个相匹配的私钥，需要自己保管好。



### 2.4 openssl 命令



